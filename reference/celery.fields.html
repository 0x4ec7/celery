<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Django Fields - celery.fields &mdash; Celery v0.9.0 (unstable) documentation</title>
    <link rel="stylesheet" href="../static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.0 (unstable)',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="Celery v0.9.0 (unstable) documentation" href="../index.html" />
    <link rel="up" title="Module API Reference" href="index.html" />
    <link rel="next" title="Celery Worker Daemon - celery.bin.celeryd" href="celery.bin.celeryd.html" />
    <link rel="prev" title="Django Models - celery.models" href="celery.models.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="celery.bin.celeryd.html" title="Celery Worker Daemon - celery.bin.celeryd"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="celery.models.html" title="Django Models - celery.models"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Celery v0.9.0 (unstable) documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module API Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-celery.fields">
<h1>Django Fields - celery.fields<a class="headerlink" href="#module-celery.fields" title="Permalink to this headline">¶</a></h1>
<p>Custom Django Model Fields.</p>
<dl class="class">
<dt id="celery.fields.PickledObject">
<em class="property">class </em><tt class="descclassname">celery.fields.</tt><tt class="descname">PickledObject</tt><a class="headerlink" href="#celery.fields.PickledObject" title="Permalink to this definition">¶</a></dt>
<dd><p>A subclass of string so it can be told whether a string is a pickled
object or not (if the object is an instance of this class then it must
[well, should] be a pickled one).</p>
<p>Only really useful for passing pre-encoded values to <tt class="docutils literal"><span class="pre">default</span></tt>
with <tt class="docutils literal"><span class="pre">dbsafe_encode</span></tt>, not that doing so is necessary. If you
remove PickledObject and its references, you won&#8217;t be able to pass
in pre-encoded values anymore, but you can always just pass in the
python objects themselves.</p>
</dd></dl>

<dl class="class">
<dt id="celery.fields.PickledObjectField">
<em class="property">class </em><tt class="descclassname">celery.fields.</tt><tt class="descname">PickledObjectField</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#celery.fields.PickledObjectField" title="Permalink to this definition">¶</a></dt>
<dd><p>A field that will accept <em>any</em> python object and store it in the
database. PickledObjectField will optionally compress it&#8217;s values if
declared with the keyword argument <tt class="docutils literal"><span class="pre">compress=True</span></tt>.</p>
<p>Does not actually encode and compress <tt class="xref docutils literal"><span class="pre">None</span></tt> objects (although you
can still do lookups using None). This way, it is still possible to
use the <tt class="docutils literal"><span class="pre">isnull</span></tt> lookup type correctly. Because of this, the field
defaults to <tt class="docutils literal"><span class="pre">null=True</span></tt>, as otherwise it wouldn&#8217;t be able to store
None values since they aren&#8217;t pickled and encoded.</p>
<dl class="method">
<dt id="celery.fields.PickledObjectField.get_db_prep_value">
<tt class="descname">get_db_prep_value</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#celery.fields.PickledObjectField.get_db_prep_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Pickle and b64encode the object, optionally compressing it.</p>
<p>The pickling protocol is specified explicitly (by default 2),
rather than as -1 or HIGHEST_PROTOCOL, because we don&#8217;t want the
protocol to change over time. If it did, <tt class="docutils literal"><span class="pre">exact</span></tt> and <tt class="docutils literal"><span class="pre">in</span></tt>
lookups would likely fail, since pickle would now be generating
a different string.</p>
</dd></dl>

<dl class="method">
<dt id="celery.fields.PickledObjectField.get_default">
<tt class="descname">get_default</tt><big>(</big><big>)</big><a class="headerlink" href="#celery.fields.PickledObjectField.get_default" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the default value for this field.</p>
<p>The default implementation on models.Field calls force_unicode
on the default, which means you can&#8217;t set arbitrary Python
objects as the default. To fix this, we just return the value
without calling force_unicode on it. Note that if you set a
callable as a default, the field will still call it. It will
<em>not</em> try to pickle and encode it.</p>
</dd></dl>

<dl class="method">
<dt id="celery.fields.PickledObjectField.to_python">
<tt class="descname">to_python</tt><big>(</big><em>value</em><big>)</big><a class="headerlink" href="#celery.fields.PickledObjectField.to_python" title="Permalink to this definition">¶</a></dt>
<dd><p>B64decode and unpickle the object, optionally decompressing it.</p>
<p>If an error is raised in de-pickling and we&#8217;re sure the value is
a definite pickle, the error is allowed to propogate. If we
aren&#8217;t sure if the value is a pickle or not, then we catch the
error and return the original value instead.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="celery.fields.dbsafe_encode">
<tt class="descclassname">celery.fields.</tt><tt class="descname">dbsafe_encode</tt><big>(</big><em>value</em>, <em>compress_object=False</em><big>)</big><a class="headerlink" href="#celery.fields.dbsafe_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>We use deepcopy() here to avoid a problem with cPickle, where dumps
can generate different character streams for same lookup value if
they are referenced differently.</p>
<p>The reason this is important is because we do all of our lookups as
simple string matches, thus the character streams must be the same
for the lookups to work properly. See tests.py for more
information.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="celery.models.html"
                                  title="previous chapter">Django Models - celery.models</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="celery.bin.celeryd.html"
                                  title="next chapter">Celery Worker Daemon - celery.bin.celeryd</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../sources/reference/celery.fields.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="celery.bin.celeryd.html" title="Celery Worker Daemon - celery.bin.celeryd"
             >next</a> |</li>
        <li class="right" >
          <a href="celery.models.html" title="Django Models - celery.models"
             >previous</a> |</li>
        <li><a href="../index.html">Celery v0.9.0 (unstable) documentation</a> &raquo;</li>
          <li><a href="index.html" >Module API Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Ask Solem.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
  </body>
</html>