<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>What’s new in Celery 2.6 &mdash; Celery 2.6.0rc3 documentation</title>
    
    <link rel="stylesheet" href="_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/issuetracker.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.6.0rc3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Celery 2.6.0rc3 documentation" href="index.html" />
    <link rel="next" title="What’s new in Celery 2.5" href="whatsnew-2.5.html" />
    <link rel="prev" title="Frequently Asked Questions" href="faq.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="whatsnew-2.5.html" title="What’s new in Celery 2.5"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently Asked Questions"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Celery 2.6.0rc3 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
<div class="deck">

    
        <p class="developmentversion">
        This document is for Celery's development version, which can be
        significantly different from previous releases. Get old docs here:

        <a href="http://docs.celeryproject.org/en/latest/whatsnew-2.6.html">2.5</a>.
        </p>
        

</div>
    <div class="section" id="what-s-new-in-celery-2-6">
<span id="whatsnew-2-6"></span><h1>What&#8217;s new in Celery 2.6<a class="headerlink" href="#what-s-new-in-celery-2-6" title="Permalink to this headline">¶</a></h1>
<p>Celery aims to be a flexible and reliable, best-of-breed solution
to process vast amounts of messages in a distributed fashion, while
providing operations with the tools to maintain such a system.</p>
<p>Celery has a large and diverse community of users and contributors,
you should come join us <a class="reference internal" href="getting-started/resources.html#irc-channel"><em>on IRC</em></a>
or <a class="reference internal" href="getting-started/resources.html#mailing-list"><em>our mailing-list</em></a>.</p>
<p>To read more about Celery you should visit our <a class="reference external" href="http://celeryproject.org/">website</a>.</p>
<p>While this version is backward compatible with previous versions
it is important that you read the following section.</p>
<p>If you use Celery in combination with Django you must also
read the <a class="reference external" href="http://bit.ly/djcelery-26-changelog">django-celery changelog</a> and upgrade to <a class="reference external" href="http://pypi.python.org/pypi/django-celery/">django-celery 2.6</a>.</p>
<p>This version is officially supported on CPython 2.5, 2.6, 2.7, 3.2 and 3.3,
as well as PyPy and Jython.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#important-notes" id="id1">Important Notes</a><ul>
<li><a class="reference internal" href="#now-depends-on-billiard" id="id2">Now depends on <tt class="xref py py-mod docutils literal"><span class="pre">billiard</span></tt>.</a></li>
<li><a class="reference internal" href="#group-chord-chain-are-now-subtasks" id="id3"><cite>group</cite>/<cite>chord</cite>/<cite>chain</cite> are now subtasks</a></li>
<li><a class="reference internal" href="#logging-improvements" id="id4">Logging Improvements</a></li>
<li><a class="reference internal" href="#unorganized" id="id5">Unorganized</a></li>
<li><a class="reference internal" href="#internals" id="id6">Internals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deprecations" id="id7">Deprecations</a></li>
<li><a class="reference internal" href="#news" id="id8">News</a><ul>
<li><a class="reference internal" href="#in-other-news" id="id9">In Other News</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fixes" id="id10">Fixes</a></li>
</ul>
</div>
<div class="section" id="important-notes">
<span id="v260-important"></span><h2><a class="toc-backref" href="#id1">Important Notes</a><a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="now-depends-on-billiard">
<h3><a class="toc-backref" href="#id2">Now depends on <tt class="xref py py-mod docutils literal"><span class="pre">billiard</span></tt>.</a><a class="headerlink" href="#now-depends-on-billiard" title="Permalink to this headline">¶</a></h3>
<p>Billiard is a fork of the multiprocessing containing
the no-execv patch by sbt (<a class="reference external" href="http://bugs.python.org/issue8713">http://bugs.python.org/issue8713</a>),
and also contains the pool improvements previously located in Celery.</p>
<p>This fork was necessary as changes to the C extension code was required
for the no-execv patch to work.</p>
<ul class="simple">
<li>Issue <span class="xref issue">#625</span></li>
<li>Issue <span class="xref issue">#627</span></li>
<li>Issue <span class="xref issue">#640</span></li>
<li><cite>django-celery <span class="xref issue">#122</span> &lt;http://github.com/ask/django-celery/issues/122</cite></li>
<li><cite>django-celery <span class="xref issue">#124</span> &lt;http://github.com/ask/django-celery/issues/122</cite></li>
</ul>
</div>
<div class="section" id="group-chord-chain-are-now-subtasks">
<h3><a class="toc-backref" href="#id3"><cite>group</cite>/<cite>chord</cite>/<cite>chain</cite> are now subtasks</a><a class="headerlink" href="#group-chord-chain-are-now-subtasks" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The source code for these, including subtask, has been moved
to new module celery.canvas.</p>
</li>
<li><p class="first">group is no longer an alias to TaskSet, but new alltogether,
since it was very difficult to migrate the TaskSet class to become
a subtask.</p>
</li>
<li><p class="first">A new shortcut has been added to tasks:</p>
<div class="highlight-python"><pre>    &gt;&gt;&gt; task.s(arg1, arg2, kw=1)

as a shortcut to::

    &gt;&gt;&gt; task.subtask((arg1, arg2), {"kw": 1})</pre>
</div>
</li>
<li><p class="first">Tasks can be chained by using the <tt class="docutils literal"><span class="pre">|</span></tt> operator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">pow</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Subtasks can be &#8220;evaluated&#8221; using the <tt class="docutils literal"><span class="pre">~</span></tt> operator:</p>
<div class="highlight-python"><pre>    &gt;&gt;&gt; ~add.s(2, 2)
    4

    &gt;&gt;&gt; ~(add.s(2, 2) | pow.s(2))

is the same as::

    &gt;&gt;&gt; chain(add.s(2, 2), pow.s(2)).apply_async().get()</pre>
</div>
</li>
<li><p class="first">A new subtask_type key has been added to the subtask dicts</p>
<blockquote>
<div><p>This can be the string &#8220;chord&#8221;, &#8220;group&#8221;, &#8220;chain&#8221;, &#8220;chunks&#8221;,
&#8220;xmap&#8221;, or &#8220;xstarmap&#8221;.</p>
</div></blockquote>
</li>
<li><p class="first">maybe_subtask now uses subtask_type to reconstruct
the object, to be used when using non-pickle serializers.</p>
</li>
<li><p class="first">The logic for these operations have been moved to dedicated
tasks celery.chord, celery.chain and celery.group.</p>
</li>
<li><p class="first">subtask no longer inherits from AttributeDict.</p>
<blockquote>
<div><p>It&#8217;s now a pure dict subclass with properties for attribute
access to the relevant keys.</p>
</div></blockquote>
</li>
<li><p class="first">The repr&#8217;s now outputs how the sequence would like imperatively:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">chord</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chord</span><span class="p">([</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())</span>
<span class="go">      | pow.s(2))</span>
<span class="go">tasks.xsum([tasks.add(0, 0),</span>
<span class="go">            tasks.add(1, 1),</span>
<span class="go">            tasks.add(2, 2),</span>
<span class="go">            tasks.add(3, 3),</span>
<span class="go">            tasks.add(4, 4),</span>
<span class="go">            tasks.add(5, 5),</span>
<span class="go">            tasks.add(6, 6),</span>
<span class="go">            tasks.add(7, 7),</span>
<span class="go">            tasks.add(8, 8),</span>
<span class="go">            tasks.add(9, 9)]) | tasks.pow(2)</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p class="first">New <a class="reference internal" href="configuration.html#std:setting-CELERYD_WORKER_LOST_WAIT"><tt class="xref std std-setting docutils literal"><span class="pre">CELERYD_WORKER_LOST_WAIT</span></tt></a> to control the timeout in
seconds before <tt class="xref py py-exc docutils literal"><span class="pre">billiard.WorkerLostError</span></tt> is raised
when a worker can not be signalled (Issue <span class="xref issue">#595</span>).</p>
<blockquote>
<div><p>Contributed by Brendon Crawford.</p>
</div></blockquote>
</li>
<li><p class="first">App instance factory methods have been converted to be cached
descriptors that creates a new subclass on access.</p>
<blockquote>
<div><p>This means that e.g. <tt class="docutils literal"><span class="pre">celery.Worker</span></tt> is an actual class
and will work as expected when:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Worker</span><span class="p">(</span><span class="n">celery</span><span class="o">.</span><span class="n">Worker</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="logging-improvements">
<h3><a class="toc-backref" href="#id4">Logging Improvements</a><a class="headerlink" href="#logging-improvements" title="Permalink to this headline">¶</a></h3>
<p>Logging support now conforms better with best practices.</p>
<ul>
<li><p class="first">Classes used by the worker no longer uses app.get_default_logger, but uses
<cite>celery.utils.log.get_logger</cite> which simply gets the logger not setting the
level, and adds a NullHandler.</p>
</li>
<li><p class="first">Loggers are no longer passed around, instead every module using logging
defines a module global logger that is used throughout.</p>
</li>
<li><p class="first">All loggers inherit from a common logger called &#8220;celery&#8221;.</p>
</li>
<li><p class="first">Before task.get_logger would setup a new logger for every task,
and even set the loglevel.  This is no longer the case.</p>
<blockquote>
<div><ul class="simple">
<li>Instead all task loggers now inherit from a common &#8220;celery.task&#8221; logger
that is set up when programs call <cite>setup_logging_subsystem</cite>.</li>
<li>Instead of using LoggerAdapter to augment the formatter with
the task_id and task_name field, the task base logger now use
a special formatter adding these values at runtime from the
currently executing task.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Redirected output from stdout/stderr is now logged to a &#8220;celery.redirected&#8221;
logger.</p>
</li>
<li><p class="first">In addition a few warnings.warn have been replaced with logger.warn.</p>
</li>
<li><p class="first">Now avoids the &#8216;no handlers for logger multiprocessing&#8217; warning</p>
</li>
</ul>
</div>
<div class="section" id="unorganized">
<h3><a class="toc-backref" href="#id5">Unorganized</a><a class="headerlink" href="#unorganized" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Task registry is no longer a global.</p>
</li>
<li><p class="first">celery.task.Task is no longer bound to an app by default,
so configuration of the task is lazy.</p>
</li>
<li><p class="first">The &#64;task decorator is now lazy when used with custom apps</p>
<blockquote>
<div><p>If <tt class="docutils literal"><span class="pre">accept_magic_kwargs</span></tt> is enabled (herby called &#8220;compat mode&#8221;), the task
decorator executes inline like before, however for custom apps the &#64;task
decorator now returns a special PromiseProxy object that is only evaluated
on access.</p>
<p>All promises will be evaluated when <cite>app.finalize</cite> is called, or implicitly
when the task registry is first used.</p>
</div></blockquote>
</li>
<li><p class="first">chain: Chain tasks together using callbacks under the hood.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">chain</span>

<span class="c"># (2 + 2) * 8 / 2</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">subtask</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
            <span class="n">mul</span><span class="o">.</span><span class="n">subtask</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="p">)),</span>
            <span class="n">div</span><span class="o">.</span><span class="n">subtask</span><span class="p">((</span><span class="mi">2</span><span class="p">,)))</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">16</span>

<span class="n">res</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">32</span>

<span class="n">res</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">The Celery instance can now be created with a broker URL</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">celery</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="n">broker</span><span class="o">=</span><span class="s">&quot;redis://&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Result backends can now be set using an URL</p>
<blockquote>
<div><p>Currently only supported by redis.  Example use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s">&quot;redis://localhost/1&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Heartbeat frequency now every 5s, and frequency sent with event</p>
<blockquote>
<div><p>The heartbeat frequency is now available in the worker event messages,
so that clients can decide when to consider workers offline based on
this value.</p>
</div></blockquote>
</li>
<li><p class="first">Module celery.actors has been removed, and will be part of cl instead.</p>
</li>
<li><p class="first">Introduces new <tt class="docutils literal"><span class="pre">celery</span></tt> command, which is an entrypoint for all other
commands.</p>
<blockquote>
<div><p>The main for this command can be run by calling <tt class="docutils literal"><span class="pre">celery.start()</span></tt>.</p>
</div></blockquote>
</li>
<li><p class="first">Tasks can now have callbacks and errbacks, and dependencies are recorded</p>
<blockquote>
<div><blockquote>
<div><ul>
<li><p class="first">The task message format have been updated with two new extension keys</p>
<blockquote>
<div><p>Both keys can be empty/undefined or a list of subtasks.</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">callbacks</span></tt></p>
<blockquote>
<div><p>Applied if the task exits successfully, with the result
of the task as an argument.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">errbacks</span></tt></p>
<blockquote>
<div><p>Applied if an error occurred while executing the task,
with the uuid of the task as an argument.  Since it may not be possible
to serialize the exception instance, it passes the uuid of the task
instead.  The uuid can then be used to retrieve the exception and
traceback of the task from the result backend.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">link</span></tt> and <tt class="docutils literal"><span class="pre">link_error</span></tt> keyword arguments has been added</dt>
<dd><p class="first">to <tt class="docutils literal"><span class="pre">apply_async</span></tt>.</p>
<blockquote class="last">
<div><p>The value passed can be either a subtask or a list of
subtasks:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">link</span><span class="o">=</span><span class="n">mul</span><span class="o">.</span><span class="n">subtask</span><span class="p">())</span>
<span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">link</span><span class="o">=</span><span class="p">[</span><span class="n">mul</span><span class="o">.</span><span class="n">subtask</span><span class="p">(),</span> <span class="n">echo</span><span class="o">.</span><span class="n">subtask</span><span class="p">()])</span>
</pre></div>
</div>
<p>Example error callback:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">error_handler</span><span class="p">(</span><span class="n">uuid</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">AsyncResult</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
    <span class="n">exc</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">propagate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Task </span><span class="si">%r</span><span class="s"> raised exception: </span><span class="si">%r</span><span class="se">\n</span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">exc</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">traceback</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">link_error</span><span class="o">=</span><span class="n">error_handler</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
</ul>
<blockquote>
<div><ul>
<li><p class="first">We now track what subtasks a task sends, and some result backends
supports retrieving this information.</p>
<blockquote>
<div><blockquote>
<div><ul>
<li><p class="first">task.request.children</p>
<blockquote>
<div><p>Contains the result instances of the subtasks
the currently executing task has applied.</p>
</div></blockquote>
</li>
<li><p class="first">AsyncResult.children</p>
<blockquote>
<div><p>Returns the tasks dependencies, as a list of
<tt class="docutils literal"><span class="pre">AsyncResult</span></tt>/<tt class="docutils literal"><span class="pre">ResultSet</span></tt> instances.</p>
</div></blockquote>
</li>
<li><p class="first">AsyncResult.iterdeps</p>
<blockquote>
<div><p>Recursively iterates over the tasks dependencies,
yielding <cite>(parent, node)</cite> tuples.</p>
<p>Raises IncompleteStream if any of the dependencies
has not returned yet.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<ul>
<li><p class="first">AsyncResult.graph</p>
<blockquote>
<div><p>A <tt class="docutils literal"><span class="pre">DependencyGraph</span></tt> of the tasks dependencies.
This can also be used to convert to dot format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;graph.dot&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">result</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">to_dot</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
<p>which can than be used to produce an image:</p>
<div class="highlight-python"><pre>$ dot -Tpng graph.dot -o graph.png</pre>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">Bugreport now available as a command and broadcast command</p>
<blockquote>
<div><ul>
<li><p class="first">Get it from a Python repl:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">celery</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">celery</span><span class="o">.</span><span class="n">bugreport</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p class="first">Use celeryctl:</p>
<div class="highlight-python"><pre>$ celeryctl report</pre>
</div>
</li>
<li><p class="first">Get it from remote workers:</p>
<div class="highlight-python"><pre>$ celeryctl inspect report</pre>
</div>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Module <tt class="docutils literal"><span class="pre">celery.log</span></tt> moved to <a class="reference internal" href="reference/celery.app.log.html#module-celery.app.log" title="celery.app.log"><tt class="xref py py-mod docutils literal"><span class="pre">celery.app.log</span></tt></a>.</p>
</li>
<li><p class="first">Module <tt class="docutils literal"><span class="pre">celery.task.control</span></tt> moved to <a class="reference internal" href="reference/celery.app.control.html#module-celery.app.control" title="celery.app.control"><tt class="xref py py-mod docutils literal"><span class="pre">celery.app.control</span></tt></a>.</p>
</li>
<li><p class="first">Adds <tt class="xref py py-meth docutils literal"><span class="pre">AsyncResult.get_leaf()</span></tt></p>
<blockquote>
<div><p>Waits and returns the result of the leaf subtask.
That is the last node found when traversing the graph,
but this means that the graph can be 1-dimensional only (in effect
a list).</p>
</div></blockquote>
</li>
<li><p class="first">Adds <tt class="docutils literal"><span class="pre">subtask.link(subtask)</span></tt> + <tt class="docutils literal"><span class="pre">subtask.link_error(subtask)</span></tt></p>
<blockquote>
<div><p>Shortcut to <tt class="docutils literal"><span class="pre">s.options.setdefault(&quot;link&quot;,</span> <span class="pre">[]).append(subtask)</span></tt></p>
</div></blockquote>
</li>
<li><p class="first">Adds <tt class="docutils literal"><span class="pre">subtask.flatten_links()</span></tt></p>
<blockquote>
<div><p>Returns a flattened list of all dependencies (recursively)</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">AsyncResult.task_id</span></tt> renamed to <tt class="docutils literal"><span class="pre">AsyncResult.id</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">TasksetResult.taskset_id</span></tt> renamed to <tt class="docutils literal"><span class="pre">.id</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">xmap(task,</span> <span class="pre">sequence)</span></tt> and <tt class="docutils literal"><span class="pre">xstarmap(task,</span> <span class="pre">sequence)</span></tt></p>
<blockquote>
<div><p>Returns a list of the results applying the task to every item
in the sequence.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">xstarmap</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">xstarmap</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span>
<span class="go">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">chunks(task,</span> <span class="pre">sequence,</span> <span class="pre">chunksize)</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">group.skew()</span></tt></p>
</li>
<li><p class="first">99% Coverage</p>
</li>
<li><p class="first"><a class="reference internal" href="configuration.html#std:setting-CELERY_QUEUES"><tt class="xref std std-setting docutils literal"><span class="pre">CELERY_QUEUES</span></tt></a> can now be a list/tuple of <tt class="xref py py-class docutils literal"><span class="pre">Queue</span></tt>
instances.</p>
<blockquote>
<div><p>Internally <a class="reference internal" href="reference/celery.app.amqp.html#celery.app.amqp.AMQP.queues" title="celery.app.amqp.AMQP.queues"><tt class="xref py py-attr docutils literal"><span class="pre">celery.amqp.queues</span></tt></a> is now a mapping of name/Queue instances,
instead of converting on the fly.</p>
</div></blockquote>
</li>
<li><p class="first">Can now specify connection for <a class="reference internal" href="reference/celery.app.control.html#celery.app.control.Control.inspect" title="celery.app.control.Control.inspect"><tt class="xref py py-class docutils literal"><span class="pre">celery.control.inspect</span></tt></a>.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">i</span> <span class="o">=</span> <span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="n">BrokerConnection</span><span class="p">(</span><span class="s">&quot;redis://&quot;</span><span class="p">))</span>
<span class="n">i</span><span class="o">.</span><span class="n">active_queues</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Module <a class="reference internal" href="reference/celery.app.task.html#module-celery.app.task" title="celery.app.task"><tt class="xref py py-mod docutils literal"><span class="pre">celery.app.task</span></tt></a> is now a module instead of a package.</p>
<blockquote>
<div><p>The setup.py install script will try to remove the old package,
if that doesn&#8217;t work for some reason you have to remove
it manually, you can do so by executing the command:</p>
<div class="highlight-python"><pre>$ rm -r $(dirname $(python -c '
    import celery;print(celery.__file__)'))/app/task/</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><tt class="xref std std-setting docutils literal"><span class="pre">CELERY_FORCE_EXECV</span></tt> is now enabled by default.</p>
<blockquote>
<div><p>If the old behavior is wanted the setting can be set to False,
or the new <em class="xref std std-option">--no-execv</em> to <strong class="program">celeryd</strong>.</p>
</div></blockquote>
</li>
<li><p class="first">Deprecated module <tt class="docutils literal"><span class="pre">celery.conf</span></tt> has been removed.</p>
</li>
<li><p class="first">The <a class="reference internal" href="configuration.html#std:setting-CELERY_TIMEZONE"><tt class="xref std std-setting docutils literal"><span class="pre">CELERY_TIMEZONE</span></tt></a> now always require the <tt class="xref py py-mod docutils literal"><span class="pre">pytz</span></tt>
library to be installed (exept if the timezone is set to <cite>UTC</cite>).</p>
</li>
<li><p class="first">The Tokyo Tyrant backend has been removed and is no longer supported.</p>
</li>
<li><p class="first">Now uses <a class="reference external" href="http://kombu.readthedocs.org/en/latest/reference/kombu.common.html#kombu.common.maybe_declare" title="(in Kombu v2.2)"><tt class="xref py py-func docutils literal"><span class="pre">maybe_declare()</span></tt></a> to cache queue declarations.</p>
</li>
<li><p class="first">There is no longer a global default for the
<a class="reference internal" href="configuration.html#std:setting-CELERYBEAT_MAX_LOOP_INTERVAL"><tt class="xref std std-setting docutils literal"><span class="pre">CELERYBEAT_MAX_LOOP_INTERVAL</span></tt></a> setting, it is instead
set by individual schedulers.</p>
</li>
</ul>
</div>
<div class="section" id="internals">
<h3><a class="toc-backref" href="#id6">Internals</a><a class="headerlink" href="#internals" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Compat modules are now generated dynamically upon use.</p>
<blockquote>
<div><p>These modules are <tt class="docutils literal"><span class="pre">celery.messaging</span></tt>, <tt class="docutils literal"><span class="pre">celery.log</span></tt>,
<tt class="docutils literal"><span class="pre">celery.decorators</span></tt> and <tt class="docutils literal"><span class="pre">celery.registry</span></tt>.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="internals/reference/celery.utils.html#module-celery.utils" title="celery.utils"><tt class="xref py py-mod docutils literal"><span class="pre">celery.utils</span></tt></a> refactored into multiple modules:</p>
<blockquote>
<div><p><a class="reference internal" href="internals/reference/celery.utils.text.html#module-celery.utils.text" title="celery.utils.text"><tt class="xref py py-mod docutils literal"><span class="pre">celery.utils.text</span></tt></a>
<a class="reference internal" href="internals/reference/celery.utils.imports.html#module-celery.utils.imports" title="celery.utils.imports"><tt class="xref py py-mod docutils literal"><span class="pre">celery.utils.imports</span></tt></a>
<a class="reference internal" href="internals/reference/celery.utils.functional.html#module-celery.utils.functional" title="celery.utils.functional"><tt class="xref py py-mod docutils literal"><span class="pre">celery.utils.functional</span></tt></a></p>
</div></blockquote>
</li>
<li><p class="first">Now using <a class="reference external" href="http://kombu.readthedocs.org/en/latest/reference/kombu.utils.encoding.html#kombu.utils.encoding" title="(in Kombu v2.2)"><tt class="xref py py-mod docutils literal"><span class="pre">kombu.utils.encoding</span></tt></a> instead of
<cite>:mod:`celery.utils.encoding</cite>.</p>
</li>
<li><p class="first">Renamed module <tt class="docutils literal"><span class="pre">celery.routes</span></tt> -&gt; <a class="reference internal" href="internals/reference/celery.app.routes.html#module-celery.app.routes" title="celery.app.routes"><tt class="xref py py-mod docutils literal"><span class="pre">celery.app.routes</span></tt></a>.</p>
</li>
<li><p class="first">Renamed package <tt class="docutils literal"><span class="pre">celery.db</span></tt> -&gt; <a class="reference internal" href="internals/reference/celery.backends.database.html#module-celery.backends.database" title="celery.backends.database"><tt class="xref py py-mod docutils literal"><span class="pre">celery.backends.database</span></tt></a>.</p>
</li>
<li><p class="first">Renamed module <tt class="docutils literal"><span class="pre">celery.abstract</span></tt> -&gt; <a class="reference internal" href="internals/reference/celery.worker.abstract.html#module-celery.worker.abstract" title="celery.worker.abstract"><tt class="xref py py-mod docutils literal"><span class="pre">celery.worker.abstract</span></tt></a>.</p>
</li>
<li><p class="first">Command-line docs are now parsed from the module docstrings.</p>
</li>
<li><p class="first">Test suite directory has been reorganized.</p>
</li>
<li><p class="first"><strong class="program">setup.py</strong> now reads docs from the <tt class="file docutils literal"><span class="pre">requirements/</span></tt> directory.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="deprecations">
<span id="v260-deprecations"></span><h2><a class="toc-backref" href="#id7">Deprecations</a><a class="headerlink" href="#deprecations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="news">
<span id="v260-news"></span><h2><a class="toc-backref" href="#id8">News</a><a class="headerlink" href="#news" title="Permalink to this headline">¶</a></h2>
<div class="section" id="in-other-news">
<h3><a class="toc-backref" href="#id9">In Other News</a><a class="headerlink" href="#in-other-news" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Now depends on Kombu 2.1.4</li>
</ul>
</div>
</div>
<div class="section" id="fixes">
<h2><a class="toc-backref" href="#id10">Fixes</a><a class="headerlink" href="#fixes" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="index.html">
  <img class="logo" src="http://cloud.github.com/downloads/ask/celery/celery_128.png" alt="Logo"/>
</a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="faq.html"
                        title="previous chapter">Frequently Asked Questions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="whatsnew-2.5.html"
                        title="next chapter">What&#8217;s new in Celery 2.5</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/whatsnew-2.6.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="whatsnew-2.5.html" title="What’s new in Celery 2.5"
             >next</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently Asked Questions"
             >previous</a> |</li>
        <li><a href="index.html">Celery 2.6.0rc3 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2012, Ask Solem &amp; Contributors.
    </div>
  </body>
</html>