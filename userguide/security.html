<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Security &mdash; Celery 2.5.0a1 documentation</title>
    
    <link rel="stylesheet" href="../_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/issuetracker.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.0a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Celery 2.5.0a1 documentation" href="../index.html" />
    <link rel="up" title="User Guide" href="index.html" />
    <link rel="next" title="Optimizing" href="optimizing.html" />
    <link rel="prev" title="Monitoring and Management Guide" href="monitoring.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="optimizing.html" title="Optimizing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="monitoring.html" title="Monitoring and Management Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Celery 2.5.0a1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">User Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
<div class="deck">

    
        <p class="developmentversion">
        This document is for Celery's development version, which can be
        significantly different from previous releases. Get old docs here:

        <a href="http://docs.celeryproject.org/en/latest/userguide/security.html">2.1</a>.
        </p>
        

</div>
    <div class="section" id="security">
<span id="guide-security"></span><h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#areas-of-concern" id="id3">Areas of Concern</a><ul>
<li><a class="reference internal" href="#broker" id="id4">Broker</a></li>
<li><a class="reference internal" href="#client" id="id5">Client</a></li>
<li><a class="reference internal" href="#worker" id="id6">Worker</a></li>
</ul>
</li>
<li><a class="reference internal" href="#serializers" id="id7">Serializers</a></li>
<li><a class="reference internal" href="#message-signing" id="id8">Message Signing</a></li>
<li><a class="reference internal" href="#intrusion-detection" id="id9">Intrusion Detection</a><ul>
<li><a class="reference internal" href="#logs" id="id10">Logs</a></li>
<li><a class="reference internal" href="#tripwire" id="id11">Tripwire</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>While Celery is written with security in mind, it should, like everything
else, be treated as an unsafe component.</p>
<p>Depending on your <a class="reference external" href="http://en.wikipedia.org/wiki/Security_policy">Security Policy</a>, there are
various steps you can take to make your Celery installation more secure.</p>
</div>
<div class="section" id="areas-of-concern">
<h2><a class="toc-backref" href="#id3">Areas of Concern</a><a class="headerlink" href="#areas-of-concern" title="Permalink to this headline">¶</a></h2>
<div class="section" id="broker">
<h3><a class="toc-backref" href="#id4">Broker</a><a class="headerlink" href="#broker" title="Permalink to this headline">¶</a></h3>
<p>It is imperative that the broker is guarded from unwanted access.
The worker must not automatically trust the messages it receives
from the broker, especially if the broker is publicly accessible.</p>
<p>If possible, the first step should be to use a firewall to deny access
to the broker, so that only white-listed machines have access to the port
the broker is listening on.</p>
<p>While firewalls are usually effective, they don&#8217;t help
if someone temporarily disables them,  leaving a statistically enough short
window of attack to be fairly safe, but then that same someone forgets
to re-enable it and it&#8217;s not detected until months later.
This along with firewall misconfiguration
happens frequently in the real world, and with all the other possible
ways to get behind private networks, this is why you should never
trust that something behind a firewall is protected, and does not need
further security measures.</p>
<p>If your broker supports fine-grained access control, like RabbitMQ,
this is something you should look at enabling.  See for example
<a class="reference external" href="http://www.rabbitmq.com/access-control.html">http://www.rabbitmq.com/access-control.html</a>.</p>
</div>
<div class="section" id="client">
<h3><a class="toc-backref" href="#id5">Client</a><a class="headerlink" href="#client" title="Permalink to this headline">¶</a></h3>
<p>In Celery, &#8220;client&#8221; refers to anything that sends
messages to the broker, e.g. web-servers that apply tasks.</p>
<p>Having your broker properly secured doesn&#8217;t matter if arbitrary messages
can be sent through a client.</p>
<p><em>[Need more text here]</em></p>
</div>
<div class="section" id="worker">
<h3><a class="toc-backref" href="#id6">Worker</a><a class="headerlink" href="#worker" title="Permalink to this headline">¶</a></h3>
<p>By default any task executed in the worker has the same access to the workers
memory space, file-system and devices as the privileges of the
current user.  That is except when using the multiprocessing pool, where
dedicated worker processes for tasks means it will have access to
any memory copied as a result of the <tt class="xref py py-func docutils literal"><span class="pre">fork()</span></tt> call (does not apply
under MS Windows), and access to memory contents written
by parent tasks in the same worker child process.</p>
<p>Limiting access to memory contents can be done by launching every task
in a subprocess (<tt class="xref py py-func docutils literal"><span class="pre">fork()</span></tt> + <tt class="xref py py-func docutils literal"><span class="pre">execve()</span></tt>).</p>
<p>Limiting file-system and device access can be accomplished by using
<a class="reference external" href="http://en.wikipedia.org/wiki/Chroot">chroot</a>, <a class="reference external" href="http://en.wikipedia.org/wiki/FreeBSD_jail">jail</a>, <a class="reference external" href="http://en.wikipedia.org/wiki/Sandbox_(computer_security)">sandboxing</a>, virtual machines or other
mechanisms as enabled by the platform or additional software.</p>
<p>Also remember that any task executed in the worker will have the
same network access as the machine it is running on, so if the worker is
located on an internal network adding firewall rules to the workers
outbound traffic is a good idea.</p>
</div>
</div>
<div class="section" id="serializers">
<h2><a class="toc-backref" href="#id7">Serializers</a><a class="headerlink" href="#serializers" title="Permalink to this headline">¶</a></h2>
<p><em>[To be written]</em></p>
</div>
<div class="section" id="message-signing">
<h2><a class="toc-backref" href="#id8">Message Signing</a><a class="headerlink" href="#message-signing" title="Permalink to this headline">¶</a></h2>
<p><em>[To be written]</em></p>
</div>
<div class="section" id="intrusion-detection">
<h2><a class="toc-backref" href="#id9">Intrusion Detection</a><a class="headerlink" href="#intrusion-detection" title="Permalink to this headline">¶</a></h2>
<p>The most important part when defending your systems against
intruders is being able to detect if the system has been compromised.</p>
<div class="section" id="logs">
<h3><a class="toc-backref" href="#id10">Logs</a><a class="headerlink" href="#logs" title="Permalink to this headline">¶</a></h3>
<p>Logs are often the first place we go to to find evidence
of security breaches, but the logs are useless if they can be tampered with.</p>
<p>The best solution is to set up centralized logging with a dedicated logging
server with restricted access that all your servers can log to.
In addition to having all of the logs in a single place, if configured
correctly it can make it harder for intruders to tamper with your logs.</p>
<p>This should be fairly easy to setup using syslog (see also <a class="reference external" href="http://en.wikipedia.org/wiki/Syslog-ng">syslog-ng</a> and
<a class="reference external" href="http://www.rsyslog.com/">rsyslog</a>.).  Celery uses the <a class="reference external" href="http://docs.python.org/dev/library/logging.html#logging" title="(in Python v3.3)"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> library, and already has
built-in support for using syslog.</p>
<p>A tip for the paranoid is to send logs using UDP and cut the
transmit part of the logging servers network cable :-)</p>
</div>
<div class="section" id="tripwire">
<h3><a class="toc-backref" href="#id11">Tripwire</a><a class="headerlink" href="#tripwire" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://tripwire.com/">Tripwire</a> is a (now commercial) data integrity tool, with several
open source implementations, used to keep
cryptographic hashes of files in the file-system, so that administrators
can be alerted when they change.  This way when the damage is done and your
system has been compromised you can tell exactly what files the intruders
changed  (password files, logs, backdoors, rootkits and so on).
Often this is the only way you will be able to detect an intrusion.</p>
<p>Some of the open source implementations include:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.ossec.net/">OSSEC</a></li>
<li><a class="reference external" href="http://la-samhna.de/samhain/index.html">Samhain</a></li>
<li><a class="reference external" href="http://sourceforge.net/projects/tripwire/">Open Source Tripwire</a></li>
<li><a class="reference external" href="http://aide.sourceforge.net/">AIDE</a></li>
</ul>
<p>Also, the <a class="reference external" href="http://en.wikipedia.org/wiki/ZFS">ZFS</a> file-system comes with built-in integrity checks
that can be used.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="../index.html">
  <img class="logo" src="http://cloud.github.com/downloads/ask/celery/celery_128.png" alt="Logo"/>
</a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="monitoring.html"
                        title="previous chapter">Monitoring and Management Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="optimizing.html"
                        title="next chapter">Optimizing</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/userguide/security.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="optimizing.html" title="Optimizing"
             >next</a> |</li>
        <li class="right" >
          <a href="monitoring.html" title="Monitoring and Management Guide"
             >previous</a> |</li>
        <li><a href="../index.html">Celery 2.5.0a1 documentation</a> &raquo;</li>
          <li><a href="index.html" >User Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, Ask Solem &amp; Contributors.
    </div>
  </body>
</html>