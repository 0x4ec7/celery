
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Executing Tasks &mdash; Celery v2.1.0rc1 documentation</title>
    <link rel="stylesheet" href="../static/celery.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/issuetracker.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1.0rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="Celery v2.1.0rc1 documentation" href="../index.html" />
    <link rel="up" title="User Guide" href="index.html" />
    <link rel="next" title="Workers Guide" href="workers.html" />
    <link rel="prev" title="Tasks" href="tasks.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="workers.html" title="Workers Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tasks.html" title="Tasks"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Celery v2.1.0rc1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">User Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="executing-tasks">
<span id="guide-executing"></span><h1>Executing Tasks<a class="headerlink" href="#executing-tasks" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference external" href="#basics" id="id1">Basics</a></li>
<li><a class="reference external" href="#eta-and-countdown" id="id2">ETA and countdown</a></li>
<li><a class="reference external" href="#expiration" id="id3">Expiration</a></li>
<li><a class="reference external" href="#serializers" id="id4">Serializers</a></li>
<li><a class="reference external" href="#connections-and-connection-timeouts" id="id5">Connections and connection timeouts.</a></li>
<li><a class="reference external" href="#routing-options" id="id6">Routing options</a></li>
<li><a class="reference external" href="#amqp-options" id="id7">AMQP options</a></li>
</ul>
</div>
<div class="section" id="basics">
<span id="executing-basics"></span><h2><a class="toc-backref" href="#id1">Basics</a><a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>Executing tasks is done with <tt class="xref py py-meth docutils literal"><span class="pre">apply_async()</span></tt>,
and its shortcut: <tt class="xref py py-meth docutils literal"><span class="pre">delay()</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">delay</span></tt> is simple and convenient, as it looks like calling a regular
function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Task</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">kwarg1</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">kwarg2</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The same thing using <tt class="docutils literal"><span class="pre">apply_async</span></tt> is written like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Task</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;kwarg1&quot;</span><span class="p">:</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;kwarg2&quot;</span><span class="p">:</span> <span class="s">&quot;y&quot;</span><span class="p">})</span>
</pre></div>
</div>
<p>While <tt class="docutils literal"><span class="pre">delay</span></tt> is convenient, it doesn&#8217;t give you as much control as using
<tt class="docutils literal"><span class="pre">apply_async</span></tt>.  With <tt class="docutils literal"><span class="pre">apply_async</span></tt> you can override the execution options
available as attributes on the <tt class="docutils literal"><span class="pre">Task</span></tt> class:  <tt class="docutils literal"><span class="pre">routing_key</span></tt>, <tt class="docutils literal"><span class="pre">exchange</span></tt>,
<tt class="docutils literal"><span class="pre">immediate</span></tt>, <tt class="docutils literal"><span class="pre">mandatory</span></tt>, <tt class="docutils literal"><span class="pre">priority</span></tt>, and <tt class="docutils literal"><span class="pre">serializer</span></tt>.
In addition you can set a countdown/eta, or provide a custom broker connection.</p>
<p>Let&#8217;s go over these in more detail. The following examples use this simple
task, which adds together two numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>You can also execute a task by name using
<a class="reference internal" href="../reference/celery.execute.html#celery.execute.send_task" title="celery.execute.send_task"><tt class="xref py py-func docutils literal"><span class="pre">send_task()</span></tt></a>, if you don&#8217;t have access to the
task class:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.execute</span> <span class="kn">import</span> <span class="n">send_task</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">send_task</span><span class="p">(</span><span class="s">&quot;tasks.add&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="eta-and-countdown">
<span id="executing-eta"></span><h2><a class="toc-backref" href="#id2">ETA and countdown</a><a class="headerlink" href="#eta-and-countdown" title="Permalink to this headline">¶</a></h2>
<p>The ETA (estimated time of arrival) lets you set a specific date and time that
is the earliest time at which your task will execute. <tt class="docutils literal"><span class="pre">countdown</span></tt> is
a shortcut to set this by seconds in the future.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>    <span class="c"># this takes at least 3 seconds to return</span>
<span class="go">20</span>
</pre></div>
</div>
<p>Note that your task is guaranteed to be executed at some time <em>after</em> the
specified date and time has passed, but not necessarily at that exact time.</p>
<p>While <tt class="docutils literal"><span class="pre">countdown</span></tt> is an integer, <tt class="docutils literal"><span class="pre">eta</span></tt> must be a <tt class="xref py py-class docutils literal"><span class="pre">datetime</span></tt> object,
specifying an exact date and time in the future. This is good if you already
have a <tt class="xref py py-class docutils literal"><span class="pre">datetime</span></tt> object and need to modify it with a
<tt class="xref py py-class docutils literal"><span class="pre">timedelta</span></tt>, or when using time in seconds is not very readable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">def</span> <span class="nf">add_tomorrow</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add this tomorrow.&quot;&quot;&quot;</span>
    <span class="n">tomorrow</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">eta</span><span class="o">=</span><span class="n">tomorrow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="expiration">
<span id="executing-expiration"></span><h2><a class="toc-backref" href="#id3">Expiration</a><a class="headerlink" href="#expiration" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">expires</span></tt> argument defines an optional expiry time,
either as seconds after task publish, or a specific date and time using
:class:~datetime.datetime`.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Task expires after one minute from now.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">expires</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Also supports datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">expires</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>When a worker receives a task that has been expired it will mark
the task as <a class="reference internal" href="tasks.html#std:state-REVOKED"><tt class="xref std std-state docutils literal"><span class="pre">REVOKED</span></tt></a> (<a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.TaskRevokedError" title="celery.exceptions.TaskRevokedError"><tt class="xref py py-exc docutils literal"><span class="pre">TaskRevokedError</span></tt></a>).</p>
</div>
<div class="section" id="serializers">
<span id="executing-serializers"></span><h2><a class="toc-backref" href="#id4">Serializers</a><a class="headerlink" href="#serializers" title="Permalink to this headline">¶</a></h2>
<p>Data passed between celery and workers has to be serialized to be
transferred. The default serializer is <tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt>, but you can
change this for each
task. There is built-in support for using <tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt>, <tt class="docutils literal"><span class="pre">JSON</span></tt>, <tt class="docutils literal"><span class="pre">YAML</span></tt>
and <tt class="docutils literal"><span class="pre">msgpack</span></tt>. You can also add your own custom serializers by registering
them into the Carrot serializer registry.</p>
<p>The default serializer (pickle) supports Python objects, like <tt class="docutils literal"><span class="pre">datetime</span></tt> and
any custom datatypes you define yourself. But since pickle has poor support
outside of the Python language, you need to choose another serializer if you
need to communicate with other languages. In that case, <tt class="docutils literal"><span class="pre">JSON</span></tt> is a very
popular choice.</p>
<p>The serialization method is sent with the message, so the worker knows how to
deserialize any task. Of course, if you use a custom serializer, this must
also be registered in the worker.</p>
<p>When sending a task the serialization method is taken from the following
places in order: The <tt class="docutils literal"><span class="pre">serializer</span></tt> argument to <tt class="docutils literal"><span class="pre">apply_async</span></tt>, the
Task&#8217;s <tt class="docutils literal"><span class="pre">serializer</span></tt> attribute, and finally the global default
<a class="reference internal" href="../configuration.html#std:setting-CELERY_TASK_SERIALIZER"><tt class="xref std std-setting docutils literal"><span class="pre">CELERY_TASK_SERIALIZER</span></tt></a> configuration directive.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">serializer</span><span class="o">=</span><span class="s">&quot;json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="connections-and-connection-timeouts">
<span id="executing-connections"></span><h2><a class="toc-backref" href="#id5">Connections and connection timeouts.</a><a class="headerlink" href="#connections-and-connection-timeouts" title="Permalink to this headline">¶</a></h2>
<p>Currently there is no support for broker connection pools in celery,
so this is something you need to be aware of when sending more than
one task at a time, as <tt class="docutils literal"><span class="pre">apply_async</span></tt>/<tt class="docutils literal"><span class="pre">delay</span></tt> establishes and
closes a connection every time.</p>
<p>If you need to send more than one task at the same time, it&#8217;s a good idea to
establish the connection yourself and pass it to <tt class="docutils literal"><span class="pre">apply_async</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">numbers</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">publisher</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">get_publisher</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">publisher</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">publisher</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">print</span><span class="p">([</span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="p">])</span>
</pre></div>
</div>
<p>The connection timeout is the number of seconds to wait before we give up
establishing the connection. You can set this with the <tt class="docutils literal"><span class="pre">connect_timeout</span></tt>
argument to <tt class="docutils literal"><span class="pre">apply_async</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">connect_timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Or if you handle the connection manually:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">publisher</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">get_publisher</span><span class="p">(</span><span class="n">connect_timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="routing-options">
<span id="executing-routing"></span><h2><a class="toc-backref" href="#id6">Routing options</a><a class="headerlink" href="#routing-options" title="Permalink to this headline">¶</a></h2>
<p>Celery uses the AMQP routing mechanisms to route tasks to different workers.
You can route tasks using the following entities: exchange, queue and routing key.</p>
<p>Messages (tasks) are sent to exchanges, a queue binds to an exchange with a
routing key. Let&#8217;s look at an example:</p>
<p>Our application has a lot of tasks, some process video, others process images,
and some gather collective intelligence about users. Some of these have
higher priority than others so we want to make sure the high priority tasks
get sent to powerful machines, while low priority tasks are sent to dedicated
machines that can handle these at their own pace.</p>
<p>For the sake of example we have only one exchange called <tt class="docutils literal"><span class="pre">tasks</span></tt>.
There are different types of exchanges that matches the routing key in
different ways, the exchange types are:</p>
<ul>
<li><p class="first">direct</p>
<blockquote>
<p>Matches the routing key exactly.</p>
</blockquote>
</li>
<li><p class="first">topic</p>
<blockquote>
<p>In the topic exchange the routing key is made up of words separated by dots (<tt class="docutils literal"><span class="pre">.</span></tt>).
Words can be matched by the wild cards <tt class="docutils literal"><span class="pre">*</span></tt> and <tt class="docutils literal"><span class="pre">#</span></tt>, where <tt class="docutils literal"><span class="pre">*</span></tt> matches one
exact word, and <tt class="docutils literal"><span class="pre">#</span></tt> matches one or many.</p>
<p>For example, <tt class="docutils literal"><span class="pre">*.stock.#</span></tt> matches the routing keys <tt class="docutils literal"><span class="pre">usd.stock</span></tt> and
<tt class="docutils literal"><span class="pre">euro.stock.db</span></tt> but not <tt class="docutils literal"><span class="pre">stock.nasdaq</span></tt>.</p>
</blockquote>
</li>
</ul>
<p>(there are also other exchange types, but these are not used by celery)</p>
<p>So, we create three queues, <tt class="docutils literal"><span class="pre">video</span></tt>, <tt class="docutils literal"><span class="pre">image</span></tt> and <tt class="docutils literal"><span class="pre">lowpri</span></tt> that bind to
our <tt class="docutils literal"><span class="pre">tasks</span></tt> exchange. For the queues we use the following binding keys:</p>
<div class="highlight-python"><pre>video: video.#
image: image.#
lowpri: misc.#</pre>
</div>
<p>Now we can send our tasks to different worker machines, by making the workers
listen to different queues:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">filename</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">routing_key</span><span class="o">=</span><span class="s">&quot;video.compress&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">filename</span><span class="p">,</span> <span class="mi">360</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">routing_key</span><span class="o">=</span><span class="s">&quot;image.rotate&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">filename</span><span class="p">,</span> <span class="n">selection</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">routing_key</span><span class="o">=</span><span class="s">&quot;image.crop&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">routing_key</span><span class="o">=</span><span class="s">&quot;misc.recommend&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Later, if the crop task is consuming a lot of resources,
we can bind some new workers to handle just the <tt class="docutils literal"><span class="pre">&quot;image.crop&quot;</span></tt> task,
by creating a new queue that binds to <tt class="docutils literal"><span class="pre">&quot;image.crop</span></tt>&#8220;.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">To find out more about routing, please see <a class="reference internal" href="routing.html#guide-routing"><em>Routing Tasks</em></a>.</p>
</div>
</div>
<div class="section" id="amqp-options">
<span id="executing-amq-opts"></span><h2><a class="toc-backref" href="#id7">AMQP options</a><a class="headerlink" href="#amqp-options" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <tt class="docutils literal"><span class="pre">mandatory</span></tt> and <tt class="docutils literal"><span class="pre">immediate</span></tt> flags are not supported by
<tt class="xref py py-mod docutils literal"><span class="pre">amqplib</span></tt> at this point.</p>
</div>
<ul class="simple">
<li>mandatory</li>
</ul>
<p>This sets the delivery to be mandatory. An exception will be raised
if there are no running workers able to take on the task.</p>
<ul class="simple">
<li>immediate</li>
</ul>
<p>Request immediate delivery. Will raise an exception
if the task cannot be routed to a worker immediately.</p>
<ul class="simple">
<li>priority</li>
</ul>
<p>A number between <tt class="docutils literal"><span class="pre">0</span></tt> and <tt class="docutils literal"><span class="pre">9</span></tt>, where <tt class="docutils literal"><span class="pre">0</span></tt> is the highest priority.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">RabbitMQ does not yet support AMQP priorities.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="../index.html">
  <img class="logo" src="http://cloud.github.com/downloads/ask/celery/celery_favicon_128.png" alt="Logo"/>
</a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tasks.html"
                        title="previous chapter">Tasks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="workers.html"
                        title="next chapter">Workers Guide</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../sources/userguide/executing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="workers.html" title="Workers Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="tasks.html" title="Tasks"
             >previous</a> |</li>
        <li><a href="../index.html">Celery v2.1.0rc1 documentation</a> &raquo;</li>
          <li><a href="index.html" >User Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2010, Ask Solem &amp; contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
  </body>
</html>